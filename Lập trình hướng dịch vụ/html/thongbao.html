<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GV - Quản Lý Thông Báo</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="../css/giaovien.css">

    <script src="../angular/angular.min.js"></script>
</head>

<body ng-app="AppThongBao" ng-controller="ThongBaoController">
    <div class="khungbao">

        <aside class="thanhben">
            <div class="dauthanhben">
                <i class="fa-solid fa-chalkboard-user"></i>
                <span>Giáo Viên Lớp</span>
            </div>
            <ul class="menuthanhben">
                <li><a href="diemdanh.html"><i class="fa-solid fa-check-to-slot"></i> Điểm danh</a></li>
                <li class="kichhoat"><a href="thongbao.html"><i class="fa-solid fa-bell"></i> Thông báo</a></li>
                <li><a href="hocsinh.html"><i class="fa-solid fa-users"></i> Danh sách lớp</a></li>
                <li class="mucdangxuat"><a href="dangnhap.html" onclick="alert('Đăng xuất!')"><i
                            class="fa-solid fa-right-from-bracket"></i> Đăng xuất</a></li>
            </ul>
        </aside>

        <main class="noidungchinh">
            <header class="dautrang">
                <div class="tieudetrang">
                    <h2>QUẢN LÝ THÔNG BÁO</h2>
                </div>
                <div class="hopthongtin">
                    <i class="fa-solid fa-circle-user" style="margin-right: 5px; font-size: 20px;"></i>
                    <span style="font-size:13px; color:#555;">GV:</span>
                    <span class="tennguoidung">Nguyễn Thị Thu Hà</span>
                </div>
            </header>

            <div class="vunglamviec">

                <div class="bocucthongbao">

                    <div class="cottrai">
                        <h3 class="tieudeform">
                            <i class="fa-solid fa-pen-to-square"></i> Soạn Tin Nhắn Mới
                        </h3>

                        <div class="nhomform">
                            <label>Tiêu đề thông báo (*)</label>
                            <input type="text" class="onhap" ng-model="tb.TieuDe"
                                placeholder="Ví dụ: Thông báo họp phụ huynh...">
                        </div>

                        <div class="nhomform">
                            <label>Loại thông báo</label>
                            <select class="onhap" ng-model="tb.LoaiThongBao">
                                <option value="Chung">Thông báo chung</option>
                                <option value="Học phí">Nhắc đóng học phí</option>
                                <option value="Sức khỏe">Tình hình sức khỏe</option>
                                <option value="Hoạt động">Hoạt động ngoại khóa</option>
                            </select>
                        </div>

                        <div class="nhomform">
                            <label>Gửi đến đối tượng (*)</label>
                            <select class="onhap" ng-model="cheDoGui" style="margin-bottom: 10px;">
                                <option value="ALL">Toàn thể phụ huynh trong lớp</option>
                                <option value="HS">Cá nhân học sinh (Riêng tư)</option>
                            </select>

                            <select class="onhap" ng-model="tb.MaHocSinh" ng-show="cheDoGui == 'HS'">
                                <option value="">-- Chọn học sinh --</option>
                                <option ng-repeat="hs in dsHocSinh" value="{{hs.MaHocSinh}}">{{hs.HoTen}}
                                    ({{hs.MaHocSinh}})</option>
                            </select>
                        </div>

                        <div class="nhomform">
                            <label>Nội dung chi tiết (*)</label>
                            <textarea class="onhap" ng-model="tb.NoiDung"
                                placeholder="Nhập nội dung tin nhắn..."></textarea>
                        </div>

                        <button class="nutbam nutgui" ng-click="guiThongBao()">
                            <i class="fa-solid fa-paper-plane"></i> Gửi Thông Báo
                        </button>
                        <button class="nutbam nutmoi" ng-click="lamMoi()">
                            <i class="fa-solid fa-rotate-right"></i> Làm mới
                        </button>
                    </div>

                    <div class="cotphai">
                        <div class="tieudelist">
                            <h3 style="font-size: 16px; color: var(--main-blue);">
                                <i class="fa-solid fa-clock-rotate-left"></i> Lịch Sử Đã Gửi
                            </h3>

                            <div class="otimkiem">
                                <input type="text" class="inputtimkiem" ng-model="tuKhoa" placeholder="Tìm kiếm...">
                                <i class="fa-solid fa-magnifying-glass icontimkiem"></i>
                            </div>
                        </div>

                        <div class="dstinnhan">
                            <div class="header-bang-gia-lap">
                                <div style="flex: 2;">Tiêu đề</div>
                                <div style="flex: 1; text-align: center;">Loại tin</div>
                                <div style="flex: 1.5;">Người nhận</div>
                                <div style="flex: 1.2;">Ngày gửi</div>
                                <div style="flex: 0.5; text-align: center;">Xóa</div>
                            </div>

                            <div class="itemtin" ng-repeat="item in dsThongBao | filter:tuKhoa">
                                <div class="cot-tieude">
                                    <span class="tieudetin">{{item.TieuDe}}</span>
                                    <p class="motanoidung" title="{{item.NoiDung}}">{{ item.NoiDung.length > 60 ?
                                        (item.NoiDung | limitTo:60) + '...' : item.NoiDung }}</p>
                                </div>

                                <div class="cot-loaitin">
                                    <span class="nhanloai" ng-class="{
                                        'nenchung': item.LoaiThongBao == 'Chung',
                                        'nenhocphi': item.LoaiThongBao == 'Học phí',
                                        'nensuckhoe': item.LoaiThongBao == 'Sức khỏe',
                                        'nenhoatdong': item.LoaiThongBao == 'Hoạt động'
                                    }">{{item.LoaiThongBao}}</span>
                                </div>

                                <div class="cot-nguoinhan">
                                    <i class="fa-solid fa-user-tag" style="color:#888; font-size: 12px;"></i>
                                    {{item.NguoiNhan}}
                                </div>

                                <div class="cot-ngaygui">
                                    {{item.NgayGui | date:'dd/MM/yyyy'}}
                                </div>

                                <div class="cot-tacvu">
                                    <button class="nutxoanho" title="Xóa" ng-click="xoaThongBao(item.MaThongBao)">
                                        <i class="fa-solid fa-trash-can"></i>
                                    </button>
                                </div>
                            </div>

                            <div ng-if="dsThongBao.length == 0" style="text-align:center; color:#999; padding:40px;">
                                <i class="fa-solid fa-inbox"
                                    style="font-size:40px; opacity: 0.5; margin-bottom: 10px;"></i>
                                <p>Chưa có thông báo nào.</p>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </main>
    </div>

    <script src="../js/thongbao.js"></script>
</body>

</html>